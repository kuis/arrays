<nav id="accordion" class="sidebar-filter" role="navigation" aria-multiselectable="true">
    <div class="sidebar-filter-heading">
        Filter Selection
    </div>
	<ul class="sidebar-filter-group">
        {% for fieldName, fieldValues in uniqueFieldValuesByFieldName %}
		<li class="sidebar-filter-group-item">
            {% set isThisAnActiveFilterColumn = false %}
            {% if isFilterActive %}
                {% if filterObj[fieldName] %}
                    {% set isThisAnActiveFilterColumn = true %}
                {% endif %}
            {% endif %}
            
			<a class="collapse-trigger" role="button" href="#column-{{ loop.index }}" aria-expanded="{{ isThisAnActiveFilterColumn }}" aria-controls="column-{{ loop.index }}">
                {{ fieldName }}
            </a>
			<ul id="column-{{ loop.index }}" class="sidebar-filter-subgroup collapse {{ "in" if isThisAnActiveFilterColumn else "" }}" aria-expanded="{{ isThisAnActiveFilterColumn }}">
                {% for fieldValue in fieldValues %}
                {% set queryParamJoinChar = "?" if routePath_withoutFilter == routePath_base else "&" %}
                {% set isThisAnActiveFilter = false %}
                {% if isThisAnActiveFilterColumn %}
                    {% if filterObj[fieldName] | doesArrayContain(fieldValue) %}
                        {% set isThisAnActiveFilter = true %}
                    {% endif %}
                {% endif %}
				<li class="sidebar-filter-subgroup-item background-color-brand-hover">
                    {% set filterObjForThisFilterColVal = filterObj | constructedFilterObj(fieldName, fieldValue, isThisAnActiveFilter) %}
                    {% set filterJSONString = filterObjForThisFilterColVal | jsonStringify %}
                    {% set urlForFilterValue = routePath_withoutFilter + queryParamJoinChar + "filterJSON=" + filterJSONString %}
                    {% if filterObjForThisFilterColVal | isObjectEmpty %}
                        {% set urlForFilterValue = routePath_withoutFilter %}
                    {% endif %}
                    <a href="{{ urlForFilterValue }}" class="{{ "sidebar-filter-active background-color-brand" if isThisAnActiveFilter else "" }}">
                        {{ fieldValue }}
                    </a>
                </li>
                {% endfor %}
			</ul>
		</li>
        {% endfor %}
	</ul>
</nav>