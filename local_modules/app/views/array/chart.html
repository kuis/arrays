{% extends "../shared/shared_layout.html" %}

{% block headSuffix %}
    <title>Arrays - {{ arrayTitle }}</title>
    
    
{% endblock %}

{% block bodyWrapper %}
    <body class="array array-show">
        <div id="page" class="site">
            {% include "../partials/header_bar_array.html" %}
            {% include "../partials/sidebar_filter.html" %}

            <div id="content" class="site-content">

                <section class="array">

                    <header class="array-header header-shadow">
                        <h1 class="array-title">{{ arrayTitle }}</h1>
                        <div class="array-meta"><a href="#" class="array-meta-about">About</a> <span class="array-meta-divider"></span> <span class="array-meta-count">{{ sourceDoc.numberOfRows | comma }} Record{{ "s" if sourceDoc.numberOfRows != 1 else "" }}</span> <span class="array-meta-divider"></span> <span class="array-meta-updated">Last Updated {{ sourceDoc.dateOfLastImport | dateFormattedAs_monthDayYear }}</span></div>
                    </header><!-- .array-header -->

                    <div class="container-fluid">
                        <div class="row">
                            <div class="col-sm-12">

                                <div class="sort-bar clearfix">

                                    <nav class="pull-left" role="navigation">

                                        <div class="dropdown sort-control">
                                            <a class="btn btn-default dropdown-toggle ui-label" type="button" id="group-by" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
                                                Group By: <span class="sort-criteria">{{ groupBy if groupBy else defaultGroupByColumnName_humanReadable }}</span>
                                            </a>
                                            <ul class="dropdown-menu" aria-labelledby="group-by">                            
                                                {% set groupBy_queryParamJoinChar = "?" if routePath_withoutGroupBy == routePath_base else "&" %}
                                                {% for colName in colNames_orderedForGroupByDropdown %}
                                                <li class="background-color-brand-hover"><a href="{{ routePath_withoutGroupBy }}{{ groupBy_queryParamJoinChar }}groupBy={{ colName }}">{{ colName }}</a></li>
                                                {% endfor %}
                                            </ul>
                                        </div>
                                    </nav>

                                </div>

                                {% if isFilterActive %}
                                <div class="filter-bar">
                                    <span class="filter-tag">{{ filterVal | safe }} <a href="{{ routePath_withoutFilter }}" class="close filter-tag-close">&times;</a></span>
                                </div>
                                {% endif %}
                            </div>
                        </div><!-- .row -->
                    </div><!-- .container-fluid -->
                </section>

                <script type="text/javascript">
                    var pieData = {{ groupedResults | dump | safe }}; 
                </script>

                <div class="container-fluid">
                    <div class="row">
                        <div class="col-sm-12">

                            <div id="chart">
                                <svg></svg>
                            </div>

                        </div>
                    </div><!-- .row -->
                </div><!-- .container-fluid -->

            </div><!-- #content -->
        </div><!-- #page -->

        <script src="https://code.jquery.com/jquery-2.2.2.min.js" integrity="sha256-36cp2Co+/62rEAAYHLmRCPIych47CvdM+uTBJwSzWjI=" crossorigin="anonymous"></script>
        
        <script type="text/javascript" src="/javascripts/lib/bootstrap/bootstrap.js"></script>

        <script type="text/javascript" src="/javascripts/lib/d3/d3.js"></script>
        <script type="text/javascript" src="/javascripts/lib/nvd3/nv.d3.js"></script>

        <script type="text/javascript" src="/javascripts/main.js"></script>
        <script type="text/javascript" src="/javascripts/module/chart.js"></script>
    </body>
{% endblock %}