<form name="uploadForm" autocomplete="off">
    <md-content layout-padding>
        <div>

            <h2>Select Your Data Source</h2>
            <div ng-hide="addingSourceType != '' || dataset.fileName">
                <p>Select a data source to import from the options below.</p>
                <ul class="dashboard-list">
                    <li><a href="#" ng-click="addSourceType('csv')">Upload a spreadsheet</a></li>
                    <li><a href="#" ng-click="">Upload a JSON file</a></li>
                    <li><a href="#" ng-click="">Connect to a SQL database</a></li>
                </ul>
            </div>

            <div ng-if="addingSourceType == 'csv'" ng-hide="dataset.fileName" class="aa-file-select">
                <label>Upload spreadsheet</label>
                <p>Select any .csv (comma-separated) or .tsv (tab-separated) file.</p>

                <input type="file" id="datafile" nv-file-select="" uploader="uploader" accept=".csv, .tsv, .tsv|text/csv,text/csv-schema,text/tsv" ng-disabled=" !uploadForm.$valid || uploader.queue.length > 0" />

                <label for="datafile" class="md-button md-dashboard " ng-disabled=" !uploadForm.$valid || uploader.queue.length > 0" >
                    Choose File
                </label>
                <p class="aa-file-select-close"><a href="#" ng-click="addSourceType('')">Go back</a></p>
            </div>

            <p class="instructions" ng-if="dataset.fileName">Datasets</p>

            <ul class="dashboard-list user-list" ng-cloak>
                <li ng-if="dataset.fileName" layout="row" layout-align="space-between center">

                    <span flex="50" class="dashboard-list-name">
                        <strong>{{dataset.fileName}}</strong>

                    </span>

                    <span class="dashboard-list-icon warn" aria-hidden="true" aria-label="Remove" flex="5" ng-click="removeSourceDialog(dataset, removeSource, $event)">
                        <i class="fa fa-remove" aria-hidden="true"></i>
                    </span>

                </li>
            </ul>
            <ul class="dashboard-list user-list" ng-if="!dataset.fileName || dataset.fileName == null" ng-cloak>
                <li ng-repeat="item in uploader.queue track by $index" layout="row" layout-align="space-between center">

                    <span ng-class="{'pending': item.isUploading }" flex="50">
                        <span class="dashboard-list-name">{{ item.file.name }}</span>
                    </span>

                    <div ng-show="uploader.isHTML5" ng-hide="item.isSuccess" class="progress-container" draggable="" flex="40">
                        <md-progress-linear md-mode="{{progressMode}}" value="{{item.progress}}"></md-progress-linear>
                    </div>

                    <div flex="5"></div>

                    <span class="dashboard-list-icon warn" ng-click="item.cancel()" ng-hide="!item.isUploading" aria-hidden="true" aria-label="Cancel Upload" flex="5">
                        <i class="fa fa-remove" aria-hidden="true"></i>
                    </span>
                    <span class="dashboard-list-icon warn" ng-click="uploader.removeAndReset(item)" ng-hide="item.isUploading" aria-hidden="true" aria-label="Delete" flex="5">
                        <i class="fa fa-remove" aria-hidden="true"></i>
                    </span>

                </li>
            </ul>
            <md-button class="md-dashboard confirm" style="margin-top: 30px" ng-click="uploader.uploadAll()"
                ng-if="uploader.queue.length > 0 && !dataset.fileName"
                ng-disabled="uploader.isUploading || !uploadForm.$valid ">
                <span class="btn-label">Import Data</span>
            </md-button>




            <div ng-if="dataset.fileName" ng-repeat="additionalDatasource in additionalDatasources">
                <div ng-if="!additionalDatasource.dataset_uid" style="margin-top: 15px">
                    <label>Upload spreadsheet</label>
                    <p>Select any .csv (comma-separated) or .tsv (tab-separated) file.</p>
                    <input type="file" id="adddatafile" nv-file-select="" uploader="additionalDatasource.uploader" accept=".csv, .tsv, .tsv|text/csv,text/csv-schema,text/tsv" class="team-uploader" />

                    <label for="adddatafile" class="md-button md-dashboard primary-action">
                        Choose File
                    </label>
                </div>
                <ul class="dashboard-list user-list" ng-if="additionalDatasource.fileName" ng-cloak>
                    <li layout="row" layout-align="space-between center">

                        <span flex="50">
                            <span class="dashboard-list-name">{{ additionalDatasource.fileName }}</span>
                        </span>

                        <span class="dashboard-list-icon warn" aria-hidden="true" aria-label="Remove" flex="5" ng-click="removeSourceDialog(additionalDatasource, removeAdditionalDatasource, $event)">
                            <i class="fa fa-remove" aria-hidden="true"></i>
                        </span>

                    </li>
                </ul>
                <div ng-repeat="item in additionalDatasource.uploader.queue track by $index" ng-if="!additionalDatasource.fileName">
                    <ul class="dashboard-list user-list" ng-cloak>
                        <li layout="row" layout-align="space-between center">

                            <span ng-class="{'pending': item.isUploading }" flex="50">
                                <span class="dashboard-list-name">{{ item.file.name }}</span>
                            </span>

                            <div ng-show="uploader.isHTML5" ng-hide="item.isSuccess" class="progress-container" draggable="" flex="40">
                                <md-progress-linear md-mode="{{progressMode}}" value="{{item.progress}}"></md-progress-linear>
                            </div>

                            <div flex="5"></div>

                            <span class="dashboard-list-icon warn" ng-click="item.cancel()" ng-hide="!item.isUploading" aria-hidden="true" aria-label="Cancel Upload" flex="5">
                                <i class="fa fa-remove" aria-hidden="true"></i>
                            </span>
                            <span class="dashboard-list-icon warn" ng-click="additionalDatasource.uploader.removeAndReset(item)" ng-hide="item.isUploading" aria-hidden="true" aria-label="Delete" flex="5">
                                <i class="fa fa-remove" aria-hidden="true"></i>
                            </span>

                        </li>
                    </ul>
                    <md-button class="md-dashboard confirm" ng-click="item.upload()" ng-if="!item.isSuccess && additionalDatasource.uploader.queue.length"
                               ng-disabled="item.isReady || item.isUploading"
                               style="margin-top: 15px">
                        <span class="btn-label">Upload</span>
                    </md-button>
                </div>

            </div>



            <div ng-if="dataset.fileName && !addingAdditionalDatasource">
                <md-input-container>
                    <md-button class="md-dashboard" ng-click="addNewDatasource()">
                        <span class="btn-label">Combine With Another Datasource</span></md-button>
                </md-input-container>
            </div>
        </div>

        <div layout="row" layout-align="space-between center" ng-hide="!dataset.fileName">

            <!--  let comment this, not fully tested with joining multiple datasets, hence not useful for now and not implemented -->
        <!--     <p>
                <a ng-click="clearAll()" class="warn">Clear All</a>
            </p> -->

            <!-- if init wizard -->

            <div class="hidden-submit">
            <md-button class="md-dashboard confirm" ng-click="navigate('dashboard.dataset.data')" md-no-ink>

                <span class="btn-label">Next</span>
            </md-button>
            </div>
        </div>
    </md-content>
</form>

<!-- <ng-include src="'/templates/blocks/dataset.empty.html'" ng-if="!dataset.title"></ng-include> -->
