<form name="vm.settingsForm" ng-submit="submitForm(vm.settingsForm.$valid)" novalidate ng-if="dataset.uid">
    <md-content layout-padding md-no-ink>

        <h2>Display Settings</h2>

        <p style="margin-bottom: 30px">Change your display and publishing settings below.</p>


        <md-input-container class="md-block" style="margin-top: 45px;">
            <label>Title</label>
            <input unique-title required name="title" ng-model="dataset.title" dataset-id="dataset._id" submitting-flag="submitting">
            <div ng-messages="vm.settingsForm.title.$error">
                <div ng-message="required">This is required.</div>
                <div ng-message="titleAvailable">This title is already used on your team.</div>
            </div>

        </md-input-container>

        <md-input-container class="md-block publish-settings">
            <label style="margin-bottom: 15px">Privacy settings</label>

            <!-- <md-switch ng-model="dataset.fe_visible"
                ng-change="updatePublishSettings()"
                aria-label="Publish dataset">
                Make dataset public
            </md-switch> -->

            <md-switch ng-model="dataset.isPublic"
                ng-change="updatePublishSettings()"
                ng-disabled="!dataset.fe_visible || dataset.sample"
                aria-label="Make dataset public">
                Allow anyone to view visualization (not only registered users)
            </md-switch>

            <md-switch ng-model="dataset.fe_listed"
                ng-change="updatePublishSettings()"
                ng-disabled="!dataset.fe_visible || !dataset.isPublic || dataset.sample"
                aria-label="List dataset">
                List visualization on your team page
            </md-switch>
        </md-input-container>

        <label>List on arrays.co</label>

        <div ng-if="(dataset.author | isSuperAdmin)">
            <md-switch ng-model="showOnArraysCo"
                ng-change="updateListingOnArrays(showOnArraysCo)"
                ng-disabled="!dataset.fe_visible || !dataset.isPublic || dataset.sample"
                aria-label="Make dataset accessible on arrays.co">
                List visualization on arrays.co
            </md-switch>
        </div>

        <div>
            <md-button ng-hide="dataset.connection || dataset.sample || user.role=='superAdmin'"
                ng-disabled="dataset.state=='approved' || dataset.state =='pending'|| !dataset.imported"
                class="md-dashboard" aria-label="More actions menu"
                ng-click="listOnArraysRequest()">
                <span class="btn-label">Request {{ dataset.state || 'listing on arrays.co' }}</span>
            </md-button>
            <p ng-if="!(dataset.author | isSuperAdmin) && !dataset.state">Visualization must be imported and listed on team page before making a request to list on array.co.</p>
        </div>

        <!-- <div ng-if="dataset.state && user.role !== 'superAdmin'">
            <h3>Request State: {{dataset.state}}</h3>
        </div> -->

        <div ng-if="user.role=='superAdmin' && dataset.state && !(dataset.author | isSuperAdmin) " >
            <h3>Request {{dataset.state}}</h3>
            <md-button class="md-dashboard" aria-label="Approve Listing On Arrays.co" ng-disabled="dataset.state == 'approved'"
                ng-click="updateListingOnArrays(true)">
                Approve
            </md-button>
            <md-button class="md-dashboard" aria-label="Approve Listing On Arrays.co" ng-disabled="dataset.state == 'disapproved'"
                ng-click="updateListingOnArrays(false)">
                Disapprove
            </md-button>
        </div>

        <!-- <md-input-container class="md-block md-input-has-placeholder">
            <label>URL</label>
            <div layout="row" layout-align="start center">
                <span class="input-prepend">{{team.subdomain}}.arrays.co/</span>
                <input required name="url" ng-model="dataset.url" ng-pattern="/^[a-z0-9\-\_]*$/" />
            </div>
            <div ng-messages="settingsForm.url.$error">
                <p ng-message="required">This field is required.</p>
			    <p ng-message="pattern">Must be lowercase and contain no whitespace.</p>
            </div>
        </md-input-container> -->

        <!-- <md-input-container class="md-block">
            <label>Import Revision (Only Available at the first import)</label>
            <input type="number" min="1" required name="importRevision"
                   ng-model="dataset.importRevision" ng-readonly="dataset.imported"/>
            <div ng-messages="settingsForm.importRevision.$error">
                <div ng-message="required">This is required.</div>
                <div ng-message="min">You should input at least 1.</div>
            </div>

        </md-input-container> -->

        <div>
            <label>Select a color for your visualization page</label>
            <aa-color-picker selected="dataset.brandColor"></aa-color-picker>
        </div>

        <div>
            <label>Upload an image to showcase your visualization</label> <span class="optional" ng-if="!dataset.banner">(optional)</span>

            <div flex="50">
                <img class="img-responsive" ng-if="dataset.banner" ng-src="{{makeUrl(dataset.banner)}}" style="margin-bottom: 15px;">
            </div>

            <input id="banner" type="file" nv-file-select="" uploader="imageUploader" class="team-uploader">
            <div layout="row" layout-align="start center">
                <label for="banner" class="md-button md-dashboard" ng-disabled="imageUploader.queue.length > 0">
                   Choose File
                </label>
            </div>
        </div>

        <md-input-container class="md-block" style="margin-top: 45px;">
            <label>Enter a description for your visualization <span class="optional">(optional)</span></label>
            <textarea name="description" ng-model="dataset.description" rows="2"></textarea>
        </md-input-container>

        <md-input-container class="md-block">
            <label>Enter a link to your source data <span class="optional">(optional)</span></label>
            <input type="url" name="source_urls" ng-model="dataset.urls[0]">
            <div ng-messages="vm.settingsForm.source_urls.$error">
                <div ng-message="url">Please enter a valid url.</div>
            </div>
        </md-input-container>

        <div layout="row" layout-align="end center" class="hidden-submit">
            <md-button class="md-dashboard confirm" type="submit" ng-disabled="vm.settingsForm.$invalid || submitting" md-no-ink>
                <span class="btn-label">Next</span>
            </md-button>
        </div>
    </md-content>
</form>
