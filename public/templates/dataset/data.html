<md-content layout-padding ng-if="dataset.uid" md-no-ink>
    <form name="vm.dataForm" ng-submit="submitForm(!vm.dataForm.$invalid )">

        <h2>Format Your Content</h2>

        <!-- quickfix spacer -->
        <div style="margin-top: 60px;"></div>

        <md-input-container class="md-block">
            <label>Select the field you'd like to use as a title for each item</label>
            <md-select required name="ObjectTitle" aria-label="Item title"
                       ng-model="data.fe_designatedFields.objectTitle"
                       >
                <md-option ng-repeat="column in dataset.columns track by column.name" value="{{column.name}}">
                    {{column.name}}
                </md-option>
            </md-select>
        </md-input-container>

        <p style="margin-top: 30px;">You can make changes to your content below.</p>

        <div layout="row" layout-align="start center">
            <md-button class="md-dashboard" ng-click="openFabricatedFilterDialog()">
                <span class="btn-label">Edit Filters</span>
            </md-button>

            <span style="margin-right: 15px"></span>

            <!-- <md-button class="md-dashboard" ng-click="">
                <span class="btn-label">Open Editor</span>
            </md-button>

            <span flex="5"></span> -->

            <md-menu>
                <md-button class="md-dashboard" aria-label="More actions menu" ng-click="$mdOpenMenu($event)">
                    More&ensp;<i class="fa fa-caret-down" aria-hidden="true"></i>
                    <span class="md-select-icon" aria-hidden="true"></span>
                </md-button>
                <md-menu-content width="4">
                    <md-menu-item>

                        <md-button ng-click="openFieldDialog($event, '', null, true, dataset.customFieldsToProcess ? dataset.customFieldsToProcess.length : 0)">
                            Add a new field
                        </md-button>
                    </md-menu-item>
                    <md-menu-item>
                        <md-button ng-click="openNestedDialog()">
                            Group data together
                        </md-button>
                    </md-menu-item>
                    <md-menu-item>
                        <md-button ng-click="openImageScrapingDialog()" ng-if="user.role=='superAdmin'">
                            Image scraping
                        </md-button>
                    </md-menu-item>
                    <md-menu-item>
                        <md-button ng-click="openJoinDialog()">
                            Join with another dataset
                        </md-button>
                    </md-menu-item>
                    <!-- Include/Exclude All toggleExclude()" -->
                </md-menu-content>
            </md-menu>
        </div>

<!-- quickfix spacer -->
<p style="margin-top: 30px;">
    ​​​​​​​We found these fields in your dataset:
</p>
        <ul class="dashboard-list user-list" ui-sortable="fieldSortableOptions" ng-model="data.fields">
            <li ng-repeat="field in data.fields" ng-class="{'custom': field.custom}"
                layout="row" layout-align="space-between center">

                <span class="order dashboard-list-icon" aa-tooltip="Drag to re-order" flex="10">
                    <span class="glyphicon glyphicon-move"></span>
                </span>

                <!-- aa-tooltip="Include/Exclude" -->
                <md-checkbox name="fe_excludeFields_{{$index}}"
                             ng-model="dataset.fe_excludeFields[field.name]"
                             ng-true-value="false"
                             ng-false-value="true"
                             ng-click="$event.stopPropagation();"
                             ng-change="setDirty(3)"
                             aria-label="Exclude {{field.name}}"
                             flex="10"
                             ></md-checkbox>
                <span flex>
                    {{ dataset.fe_displayTitleOverrides[field.name] || field.name }}
                    <span class="sample">

                        <span ng-if="!field.custom">(Sample: {{ field.sample | limitTo:35 }})</span>
                        <!-- <span ng-if="field.customField" ng-repeat="mergeField in field.customField.fieldsToMergeIntoArray">{{mergeField}}<span ng-if="!$last">,</span>)</span> -->
                    </span>
                </span>

                <span class="dashboard-list-icon" flex="5" aa-tooltip="Edit field"
                    ng-click="openFieldDialog($event, field.name, field.sample, field.custom, field.customFieldIndex)">
                    <i class="fa fa-pencil" aria-hidden="true"></i>
                </span>

            </li>
        </ul>

        <div layout="row" layout-align="end center" class="hidden-submit">
            <md-button class="md-dashboard confirm" type="submit" ng-disabled="vm.dataForm.$invalid">
                <span class="btn-label">Next</span>
            </md-button>
        </div>
    </form>
</md-content>

<!-- <ng-include src="'/templates/blocks/dataset.empty.html'" ng-if="!dataset.uid"></ng-include> -->
